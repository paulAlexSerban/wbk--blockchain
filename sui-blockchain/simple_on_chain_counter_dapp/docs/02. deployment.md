# Deployment Guide - Simple On-Chain Counter DApp

This guide covers the complete deployment process for the Sui Move counter smart contract.

## Prerequisites

- Sui CLI installed (https://docs.sui.io/guides/developer/getting-started/sui-install)
- Basic understanding of Sui blockchain and Move language

## Phase 1: Build the Contract

### Step 1: Build the Move Package

Navigate to the contract directory and build:

```bash
cd simple_on_chain_counter_dapp__contract
sui move build
```

**Expected Output:**
```
INCLUDING DEPENDENCY Sui
INCLUDING DEPENDENCY MoveStdlib
BUILDING simple_on_chain_counter_dapp__contract
```

If you see any warnings or errors, resolve them before proceeding.

---

## Phase 2: Setup Sui CLI for Testnet

### Step 2: Check Sui CLI Installation

Verify Sui CLI is installed:

```bash
sui --version
```

### Step 3: Configure Sui CLI for Testnet

Check your current environment:

```bash
sui client active-env
```

If it's not set to testnet, switch to testnet:

```bash
sui client switch --env testnet
```

Or add testnet if it doesn't exist:

```bash
sui client new-env --alias testnet --rpc https://fullnode.testnet.sui.io:443
sui client switch --env testnet
```

### Step 4: Create or Import a Wallet

Check if you have an active address:

```bash
sui client active-address
```

If you don't have an address, create a new one:

```bash
sui client new-address ed25519
```

This will generate a new keypair and display:
- Recovery phrase (save this securely!)
- Address

**IMPORTANT:** Save your recovery phrase in a secure location. You'll need it to recover your wallet.

To see all your addresses:

```bash
sui client addresses
```

### Step 5: Get Testnet SUI Tokens

You need SUI tokens to pay for gas fees. Get them from the testnet faucet:

**Option 1: Using Sui CLI**
```bash
sui client faucet
```

**Option 2: Using Discord**
1. Join Sui Discord: https://discord.gg/sui
2. Go to #testnet-faucet channel
3. Type: `!faucet <your-address>`

**Option 3: Using Web Faucet**
Visit: https://faucet.triangleplatform.com/sui/testnet

### Step 6: Verify Your Balance

Check that you received the tokens:

```bash
sui client gas
```

You should see some SUI tokens (usually 10 SUI from faucet).

---

## Phase 3: Deploy to Testnet

### Step 7: Publish the Contract

From the contract directory, publish to testnet:

```bash
sui client publish --gas-budget 100000000
```

**What this does:**
- `--gas-budget 100000000`: Sets maximum gas to spend (0.1 SUI)

**Expected Output:**
```
INCLUDING DEPENDENCY Sui
INCLUDING DEPENDENCY MoveStdlib
BUILDING simple_on_chain_counter_dapp__contract
Successfully verified dependencies on-chain against source.
Transaction Digest: <TRANSACTION_HASH>
```

### Step 8: Save Important Information

From the output, save these critical values:

1. **Transaction Digest** - The hash of the publish transaction
2. **Package ID** - Look for "Published Objects" section, find the object with type "package"
   ```
   ╭───────────────────────────────────────────────────────────────────────╮
   │ Published Objects                                                      │
   ├───────────────────────────────────────────────────────────────────────┤
   │  PackageID: 0x... <-- SAVE THIS                                      │
   ╰───────────────────────────────────────────────────────────────────────╯
   ```

3. **Module Name** - `simple_on_chain_counter_dapp__contract`

**Save these in a file for reference:**

```bash
# Create a deployment info file
cat > deployment-info.txt << EOF
Package ID: <your-package-id>
Transaction Hash: <your-transaction-hash>
Module: simple_on_chain_counter_dapp__contract
Network: Sui Testnet
Deployed: $(date)
EOF
```

---

## Phase 4: Verify Deployment

### Step 9: Verify on Sui Explorer

1. Go to Sui Testnet Explorer: https://suiscan.xyz/testnet/home

2. Search for your Package ID in the search bar

3. Verify you can see:
   - Your published package
   - The module: `simple_on_chain_counter_dapp__contract`
   - Functions: `create_counter`, `increment`, `get_value`

### Step 10: Verify Package Details

You can also verify via CLI:

```bash
sui client object <PACKAGE_ID>
```

---

## Phase 5: Test the Deployed Contract

### Step 11: Create a Counter

Call the `create_counter` function:

```bash
sui client call \
  --package <PACKAGE_ID> \
  --module simple_on_chain_counter_dapp__contract \
  --function create_counter \
  --gas-budget 10000000
```

**Expected Output:**
- Transaction Digest
- Created Objects section showing your new Counter object

**Save the Counter Object ID** from the output:
```
╭─────────────────────────────────────────────────────────────────────╮
│ Created Objects                                                      │
├─────────────────────────────────────────────────────────────────────┤
│  ID: 0x... <-- SAVE THIS COUNTER ID                                │
╰─────────────────────────────────────────────────────────────────────╯
```

### Step 12: Increment the Counter

Increment your counter:

```bash
sui client call \
  --package <PACKAGE_ID> \
  --module simple_on_chain_counter_dapp__contract \
  --function increment \
  --args <COUNTER_OBJECT_ID> \
  --gas-budget 10000000
```

### Step 13: Verify Counter State

Check the counter object state:

```bash
sui client object <COUNTER_OBJECT_ID>
```

Look for the `count` field in the output - it should show `1` after the first increment.

### Step 14: Test Multiple Increments

Try incrementing again to verify it works:

```bash
sui client call \
  --package <PACKAGE_ID> \
  --module simple_on_chain_counter_dapp__contract \
  --function increment \
  --args <COUNTER_OBJECT_ID> \
  --gas-budget 10000000
```

Check the object again:
```bash
sui client object <COUNTER_OBJECT_ID>
```

The `count` field should now show `2`.

---

## Troubleshooting

### Common Issues

**Issue: "Insufficient gas"**
- Solution: Request more SUI from faucet or increase gas budget

**Issue: "Package not found"**
- Solution: Verify Package ID is correct and transaction was successful

**Issue: "Object not found"**
- Solution: Ensure you're using the correct Counter Object ID

**Issue: "Invalid transaction"**
- Solution: Check you're on testnet environment (`sui client active-env`)

### Useful Commands

```bash
# Check active environment
sui client active-env

# List all environments
sui client envs

# Check active address
sui client active-address

# Check gas objects
sui client gas

# View transaction details
sui client transaction-block <TRANSACTION_DIGEST>

# View object details
sui client object <OBJECT_ID>
```

---

## Summary Checklist

- [ ] Contract built successfully (`sui move build`)
- [ ] Sui CLI configured for testnet
- [ ] Wallet created and funded with testnet SUI
- [ ] Contract published to testnet
- [ ] Package ID saved
- [ ] Transaction hash saved
- [ ] Deployment verified on Sui Explorer
- [ ] Counter created successfully
- [ ] Counter incremented successfully
- [ ] Counter state verified on-chain

---

## Next Steps

After successful deployment:

1. Update README.md with Package ID and Transaction Hash
2. Document your implementation in the README
3. Add build and deployment instructions
4. Prepare repository for submission

## Resources

- Sui Documentation: https://docs.sui.io/
- Sui Move Concepts: https://docs.sui.io/concepts/sui-move-concepts
- Sui Testnet Explorer: https://suiscan.xyz/testnet/home
- Sui Move Examples: https://examples.sui.io/
- Sui Discord: https://discord.gg/sui
